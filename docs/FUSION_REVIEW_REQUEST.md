# v21 èåˆæ–¹æ¡ˆå®¡æŸ¥è¯·æ±‚

**å®¡æŸ¥è¯·æ±‚æ—¥æœŸ**: 2025-12-17  
**å®¡æŸ¥èŒƒå›´**: ç›¯ç›˜é›·è¾¾ + æ˜æ—¥æ½œåŠ› + AI é‡åŒ–ç­–ç•¥èåˆ

---

## ğŸ“‹ å®¡æŸ¥èƒŒæ™¯

åŸºäº v20 æ¶æ„æ–¹æ¡ˆï¼Œå®Œæˆäº†ç›¯ç›˜é›·è¾¾ä¸æ˜æ—¥æ½œåŠ›æ¨¡å—ä¸ AI é‡åŒ–ç­–ç•¥çš„æ·±åº¦èåˆã€‚è¯·å®¡æŸ¥ä»¥ä¸‹å˜æ›´çš„æ­£ç¡®æ€§ã€æ¶æ„åˆç†æ€§å’Œæ½œåœ¨é£é™©ã€‚

---

## ğŸ†• æ–°å¢åç«¯æ¨¡å—

### 1. ç»Ÿä¸€è¯„åˆ†ç³»ç»Ÿ

**æ–‡ä»¶**: [scorer.py](file:///Users/wangfangchun/ä¸œé£ç ´/services/signal-api/signal_api/core/quant/scorer.py)

**å˜æ›´å†…å®¹**:

- 5 ç»´åŠ æƒè¯„åˆ†ç®—æ³•ï¼ˆæ¶¨å¹… 40%ã€æ¢æ‰‹ 25%ã€æˆäº¤é¢ 20%ã€å½¢æ€ 10%ã€é‡ä»· 5%ï¼‰
- `StrengthLevel` æšä¸¾ï¼ˆæå¼º/å¼ºåŠ¿çªç ´/åŠ é€Ÿä¸Šæ¶¨/ç¨³æ­¥ä¸Šå‡/æ¸©å’Œå¯åŠ¨/å¼±åŠ¿ï¼‰
- `RiskLevel` æšä¸¾ï¼ˆé«˜é£é™©/ä¸­é«˜/ä¸­ç­‰/ä½é£é™©ï¼‰
- å…¨å±€ `get_scorer()` å•ä¾‹

**å®¡æŸ¥è¦ç‚¹**:

- [ ] è¯„åˆ†æƒé‡æ˜¯å¦åˆç†ï¼Ÿ
- [ ] ç­‰çº§é˜ˆå€¼åˆ’åˆ†æ˜¯å¦æ°å½“ï¼Ÿ

---

### 2. ç­–ç•¥é€‚é…å™¨

**æ–‡ä»¶**: [adapters.py](file:///Users/wangfangchun/ä¸œé£ç ´/services/signal-api/signal_api/core/quant/adapters.py)

**å˜æ›´å†…å®¹**:

- `IgnitionAdapter`: ç›¯ç›˜é›·è¾¾ â†’ ç‚¹ç«ç­–ç•¥è¯„ä¼°
- `AmbushAdapter`: æ˜æ—¥æ½œåŠ› â†’ æ½œä¼ç­–ç•¥è¯„ä¼°
- é£æ§æ£€æŸ¥å‰ç½®é›†æˆ
- æ“ä½œå»ºè®®ç”Ÿæˆï¼ˆä¹°å…¥/è§‚å¯Ÿ/å›é¿ï¼‰

**å®¡æŸ¥è¦ç‚¹**:

- [ ] é€‚é…å™¨èŒè´£æ˜¯å¦å•ä¸€ï¼Ÿ
- [ ] ç‚¹ç«è§¦å‘æ¡ä»¶æ˜¯å¦åˆç†ï¼ˆignition_score >= 60ï¼‰ï¼Ÿ

---

### 3. ä¿¡å·ç®¡é“

**æ–‡ä»¶**: [pipeline.py](file:///Users/wangfangchun/ä¸œé£ç ´/services/signal-api/signal_api/core/quant/pipeline.py)

**å˜æ›´å†…å®¹**:

- `SignalPipeline`: ç»Ÿä¸€ä¿¡å·å¤„ç†æµç¨‹
- è¯„åˆ†è¿‡æ»¤ï¼ˆmin_unified_score = 40ï¼‰
- ç­–ç•¥åˆ†æ•°è¿‡æ»¤ï¼ˆmin_strategy_score = 50ï¼‰
- é£æ§æ£€æŸ¥é›†æˆ
- æ‰¹é‡å¤„ç†å’Œç»Ÿè®¡

**å®¡æŸ¥è¦ç‚¹**:

- [ ] è¿‡æ»¤é˜ˆå€¼æ˜¯å¦åˆé€‚ï¼Ÿ
- [ ] å¼‚å¸¸å¤„ç†æ˜¯å¦å®Œå–„ï¼Ÿ

---

### 4. AI å®¡æ ¸æ¨¡å—

**æ–‡ä»¶**: [reviewer.py](file:///Users/wangfangchun/ä¸œé£ç ´/services/signal-api/signal_api/core/quant/reviewer.py)

**å˜æ›´å†…å®¹**:

- `AIReviewer`: DeepSeek AI ä¿¡å·å¤æ ¸
- `StatsTracker`: å†å²èƒœç‡ç»Ÿè®¡
- å®¡è®¡æ—¥å¿—è®°å½•
- åŒæ­¥/å¼‚æ­¥å®¡æ ¸æ¨¡å¼

**å®¡æŸ¥è¦ç‚¹**:

- [ ] AI å®¡æ ¸é™çº§é€»è¾‘æ˜¯å¦æ­£ç¡®ï¼Ÿ
- [ ] ç»Ÿè®¡æ•°æ®æŒä¹…åŒ–æ˜¯å¦å¯é ï¼Ÿ

---

## ğŸ”§ ä¿®æ”¹åç«¯æ–‡ä»¶

### limit_up.py

**æ–‡ä»¶**: [limit_up.py](file:///Users/wangfangchun/ä¸œé£ç ´/services/signal-api/signal_api/routers/limit_up.py)

**å˜æ›´å†…å®¹**:

- é›†æˆ `UnifiedScorer` æ›¿æ¢ç®€åŒ–è¯„åˆ†
- `/realtime-predictions` æ–°å¢å­—æ®µ: `riskLevel`, `volumeRatio`
- `/second-board-candidates` æ–°å¢å­—æ®µ: `unifiedScore`, `strengthLevel`, `riskLevel`, `reasons`
- æ™‹çº§æ¦‚ç‡è®¡ç®—æ”¹ä¸ºåŸºäºç»Ÿä¸€åˆ†æ•°

**å®¡æŸ¥è¦ç‚¹**:

- [ ] å‘åå…¼å®¹æ€§æ˜¯å¦ä¿æŒï¼Ÿ
- [ ] å¼‚å¸¸å›é€€é€»è¾‘æ˜¯å¦æ­£ç¡®ï¼Ÿ

---

## ğŸ¨ å‰ç«¯å˜æ›´

### RealtimeLimitUpPredictor.tsx

**å˜æ›´å†…å®¹**:

- æ¥å£æ–°å¢: `riskLevel`, `predictionLevel`, `predictionReasons`, `consecutive_days`
- æ˜¾ç¤ºé£é™©ç­‰çº§æ ‡ç­¾
- æ˜¾ç¤ºè¿æ¿ä¿¡æ¯
- ä½¿ç”¨ `predictionReasons` æ›¿ä»£ `signals`

### TomorrowSecondBoardCandidates.tsx

**å˜æ›´å†…å®¹**:

- æ¥å£æ–°å¢: `unifiedScore`, `strengthLevel`, `riskLevel`, `reasons`
- æ˜¾ç¤ºç»Ÿä¸€è¯„åˆ†

### RealtimeLimitUpPredictor.css

**å˜æ›´å†…å®¹**:

- æ–°å¢ `.risk-high`, `.risk-medium-high`, `.risk-normal` é£é™©ç­‰çº§æ ·å¼
- æ–°å¢ `.consecutive` è¿æ¿æ ‡ç­¾æ ·å¼

**å®¡æŸ¥è¦ç‚¹**:

- [ ] å‰ç«¯ç±»å‹å®šä¹‰æ˜¯å¦ä¸åç«¯ä¸€è‡´ï¼Ÿ
- [ ] CSS æ ·å¼æ˜¯å¦ä¸ç°æœ‰è®¾è®¡ç»Ÿä¸€ï¼Ÿ

---

## ğŸ“Š æ•°æ®æµå›¾

```
è¾“å…¥æ•°æ®
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UnifiedScorer â”‚  â† 5ç»´è¯„åˆ†
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Adapter     â”‚  â† ç­–ç•¥è¯„ä¼° (Ignition/Ambush)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RiskManager  â”‚  â† é£æ§æ£€æŸ¥
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AIReviewer   â”‚  â† AI å¤æ ¸ (å¯é€‰)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ StatsTracker  â”‚  â† ç»Ÿè®¡è¿½è¸ª
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
ä¿¡å·è¾“å‡º
```

---

## âœ… æµ‹è¯•ç»“æœ

| æ¨¡å—          | æµ‹è¯•å‘½ä»¤                                                                      | ç»“æœ |
| ------------- | ----------------------------------------------------------------------------- | ---- |
| UnifiedScorer | `python -c "from signal_api.core.quant.scorer import get_scorer"`             | âœ…   |
| Adapters      | `python -c "from signal_api.core.quant.adapters import get_ignition_adapter"` | âœ…   |
| Pipeline      | `python -c "from signal_api.core.quant.pipeline import get_signal_pipeline"`  | âœ…   |
| Reviewer      | `python -c "from signal_api.core.quant.reviewer import get_stats_tracker"`    | âœ…   |
| Frontend      | `npx tsc --noEmit --skipLibCheck`                                             | âœ…   |

---

## âš ï¸ æ½œåœ¨é£é™©

1. **æ€§èƒ½**: æ¯ä¸ªä¿¡å·éƒ½è¿›è¡Œ 5 ç»´è¯„åˆ†è®¡ç®—ï¼Œé«˜å¹¶å‘ä¸‹å¯èƒ½æœ‰å»¶è¿Ÿ
2. **å…¼å®¹æ€§**: æ–°å¢çš„ API å­—æ®µéœ€è¦å‰ç«¯åŒæ­¥æ›´æ–°
3. **AI ä¾èµ–**: DeepSeek API ä¸å¯ç”¨æ—¶éœ€è¦ä¼˜é›…é™çº§
4. **æ•°æ®æŒä¹…åŒ–**: StatsTracker ä½¿ç”¨æœ¬åœ° JSON æ–‡ä»¶ï¼Œç”Ÿäº§ç¯å¢ƒéœ€è€ƒè™‘åˆ†å¸ƒå¼

---

## ğŸ“ å¾…ç¡®è®¤äº‹é¡¹

1. è¯„åˆ†é˜ˆå€¼ï¼ˆmin_unified_score=40, min_strategy_score=50ï¼‰æ˜¯å¦éœ€è¦è°ƒæ•´ï¼Ÿ
2. AI å®¡æ ¸é»˜è®¤æ˜¯å¦å¯ç”¨ï¼Ÿ
3. ç»Ÿè®¡æ•°æ®æ˜¯å¦éœ€è¦åˆ†å¸ƒå¼å­˜å‚¨ï¼Ÿ
