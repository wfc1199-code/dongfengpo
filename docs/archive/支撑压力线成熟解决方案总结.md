# 支撑压力线成熟解决方案总结

## 一、经典方法汇总

### 1. 🏆 Pivot Points（枢轴点法）- 最成熟广泛使用

**标准枢轴点计算公式：**
```
PP (Pivot Point) = (High + Low + Close) / 3

支撑位：
S1 = (PP × 2) - High
S2 = PP - (High - Low)
S3 = Low - 2(High - PP)

压力位：
R1 = (PP × 2) - Low
R2 = PP + (High - Low)
R3 = High + 2(PP - Low)
```

**优点：**
- ✅ 公式明确，计算简单
- ✅ 全球交易者广泛使用，具有自我实现特性
- ✅ 提供多层支撑压力位（S1-S3, R1-R3）
- ✅ 适合日内交易和短线交易

**变体：**
- **Woodie's Pivot Points**: 更重视收盘价
  ```
  PP = (High + Low + 2 × Close) / 4
  ```
- **Camarilla Pivot Points**: 更精确的日内交易
- **Fibonacci Pivot Points**: 结合斐波那契比例

---

### 2. 📊 前高前低法（Historical High/Low）

**计算方法：**
- 识别最近N天的最高价和最低价（N = 5, 10, 20, 60等）
- 前期高点作为压力位
- 前期低点作为支撑位

**多时间周期：**
```
短期：5日高低点（强支撑压力）
中期：20日高低点
长期：60日/半年高低点（关键位置）
```

**优点：**
- ✅ 基于实际成交价格，真实有效
- ✅ 市场记忆效应强
- ✅ 容易识别和验证

---

### 3. 🔢 斐波那契回撤法（Fibonacci Retracement）

**关键比例：**
```
23.6%  - 浅回撤
38.2%  - 常见支撑/压力
50.0%  - 中轴回撤
61.8%  - 黄金分割（最重要）
78.6%  - 深回撤
```

**计算方法：**
```
支撑位 = High - (High - Low) × 斐波那契比例
压力位 = Low + (High - Low) × 斐波那契比例
```

**优点：**
- ✅ 理论基础深厚（黄金分割）
- ✅ 适合波段交易
- ✅ 预测性强

---

### 4. 📈 移动平均线法（Moving Averages）

**常用周期：**
- MA5, MA10 - 短期支撑压力
- MA20, MA30 - 中期支撑压力
- MA60, MA120, MA250 - 长期关键位置

**动态特性：**
- 上升趋势中，MA作为动态支撑
- 下降趋势中，MA作为动态压力

**优点：**
- ✅ 动态调整，跟随趋势
- ✅ 使用广泛，市场认可度高
- ✅ 结合多周期MA效果更好

---

### 5. 📦 成交量密集区法（Volume Profile）

**识别方法：**
- 统计每个价格区间的成交量
- 成交量最大的区域 = 重要支撑/压力
- 成交量稀疏区域 = 弱支撑压力

**原理：**
- 大量交易发生的价位，市场参与者有强烈记忆
- 价格回到该区域时，容易产生支撑/压力作用

**优点：**
- ✅ 反映真实市场参与度
- ✅ 结合价格和成交量
- ✅ 适合识别关键价位

---

### 6. 📐 趋势线法（Trendlines）

**绘制方法：**
- 连接至少2个低点 = 上升趋势线（支撑）
- 连接至少2个高点 = 下降趋势线（压力）

**强度判断：**
- 触及次数越多，趋势线越强
- 角度越陡，越容易被突破

**优点：**
- ✅ 视觉化强，直观易懂
- ✅ 反映市场趋势
- ✅ 动态调整

---

### 7. 🎯 整数价位法（Round Numbers）

**心理价位：**
```
100, 150, 200, 250, 300...  （整百）
110, 120, 130...            （整十）
1.50, 2.00, 2.50...         （整数/半数）
```

**原理：**
- 交易者倾向在整数价位下单
- 大量止损/止盈单集中在整数位
- 自我实现的支撑压力效应

**优点：**
- ✅ 心理学基础
- ✅ 计算简单
- ✅ 全球市场通用

---

### 8. 🌊 波浪理论法（Elliott Wave）

**关键位置：**
- 第4浪回撤不能低于第1浪高点
- 第2浪回撤通常在50%-61.8%
- 第5浪目标位 = 第1浪高度

**优点：**
- ✅ 理论体系完整
- ✅ 预测性强
- ✅ 结合斐波那契比例

---

## 二、推荐混合方案

### 方案A: 专业交易者方案

**组合方法：**
1. **Pivot Points（枢轴点）** - 提供日内多层支撑压力
2. **前高前低** - 识别关键价位
3. **斐波那契回撤** - 计算波段目标位
4. **整数价位** - 心理关键位

**实现逻辑：**
```python
def calculate_support_resistance_pro(data):
    levels = []
    
    # 1. 计算标准枢轴点（3条支撑 + 3条压力）
    pp = (high + low + close) / 3
    levels.extend(calculate_pivot_points(pp, high, low))
    
    # 2. 前高前低（多周期）
    levels.append(max(high[-5:]))   # 5日高点
    levels.append(min(low[-5:]))    # 5日低点
    levels.append(max(high[-20:]))  # 20日高点
    levels.append(min(low[-20:]))   # 20日低点
    
    # 3. 斐波那契关键位
    wave_high = max(high[-20:])
    wave_low = min(low[-20:])
    levels.extend(fibonacci_levels(wave_high, wave_low))
    
    # 4. 整数价位
    levels.extend(round_numbers(current_price))
    
    # 5. 去重并排序，筛选最重要的5-7条线
    return filter_and_rank(levels)
```

---

### 方案B: 简化实用方案

**组合方法：**
1. **前5日/20日高低点** - 短中期关键位
2. **标准枢轴点** - 日内支撑压力
3. **整数价位** - 心理关键位

**特点：**
- ✅ 计算简单快速
- ✅ 实用性强
- ✅ 适合大多数股票

---

### 方案C: 量化增强方案

**组合方法：**
1. **成交量密集区** - 识别真实支撑压力
2. **前高前低** - 关键价位
3. **移动平均线** - 动态支撑压力
4. **枢轴点** - 日内交易位

**特点：**
- ✅ 结合价格和成交量
- ✅ 动态 + 静态支撑压力
- ✅ 适合量化交易

---

## 三、实现建议

### 推荐方案：方案A（专业交易者方案）

**理由：**
1. 结合多种成熟方法，互相验证
2. 提供短中长期多层支撑压力
3. 理论基础扎实，市场认可度高
4. 适合A股市场特点

**显示策略：**
- **固定支撑压力线（实线）**：前高前低、整数价位
- **动态支撑压力线（虚线）**：枢轴点、斐波那契位

**线条数量控制：**
- 总共显示5-7条最重要的线
- 根据强度和当前价格筛选

**颜色方案：**
- 强支撑（前低点）：深绿色 `#00C853` 粗实线
- 一般支撑（枢轴点S1）：浅绿色 `#4CAF50` 细虚线
- 强压力（前高点）：深红色 `#FF1744` 粗实线
- 一般压力（枢轴点R1）：浅红色 `#EF5350` 细虚线
- 整数价位：黄色 `#FFC107` 点虚线

---

## 四、对比当前方案

### 当前通达信方案的问题：
- ❌ 只用7/8和0.5/8固定比例，过于机械
- ❌ 不考虑历史价格走势
- ❌ 不考虑成交量
- ❌ 参考价值低

### 新方案的优势：
- ✅ 基于市场实际行为
- ✅ 结合多种成熟理论
- ✅ 国际通用，市场认可度高
- ✅ 可配置、可扩展

---

## 五、下一步行动

您可以选择：

1. **方案A - 专业交易者方案**（推荐）
   - 完整实现Pivot Points + 前高前低 + 斐波那契 + 整数价位

2. **方案B - 简化实用方案**
   - 快速实现，专注于前高前低 + 枢轴点

3. **方案C - 量化增强方案**
   - 加入成交量分析，适合量化交易

**我的建议：先实现方案A，效果好再考虑扩展到方案C**

需要我开始实现吗？
