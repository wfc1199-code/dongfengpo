# åˆ†æ—¶æ•°æ®å¤„ç†ä¸­å¿ƒæœåŠ¡æ€»è§ˆ

æœ¬æ–‡ä»¶æ¢³ç†é‡æ„åå„ç‹¬ç«‹æœåŠ¡/æ¨¡å—çš„å®šä½ã€å…³é”®èŒè´£ä¸è¿è¡Œæ–¹å¼ï¼Œä¾¿äºå¿«é€Ÿç†è§£ç«¯åˆ°ç«¯é“¾è·¯ã€‚æœåŠ¡æŒ‰ç…§æ•°æ®æµå‘æ’åºã€‚

## 1. æ•°æ®é‡‡é›†å±‚

| æœåŠ¡ | ç›®å½• | ä¸»è¦èŒè´£ | è¾“å…¥ | è¾“å‡º |
| --- | --- | --- | --- | --- |
| `collector-gateway` | `services/collector-gateway` | é‡‡é›†è…¾è®¯ç­‰è¡Œæƒ…æºå¹¶å†™å…¥ Redis Stream | å¤–éƒ¨è¡Œæƒ…æ¥å£ | `dfp:raw_ticks` Stream |
| `stream-buffer` | `services/stream-buffer` | å¯¹é‡‡é›†æµè¿›è¡Œå¤åˆ¶ã€åˆ†å‘ã€é•¿åº¦æ§åˆ¶ | `dfp:raw_ticks` | å¤šä¸ª Raw/Backup Stream |

## 2. æ•°æ®æ¸…æ´—ä¸å­˜å‚¨

| æœåŠ¡ | ä¸»è¦èŒè´£ | è¾“å…¥ | è¾“å‡º |
| --- | --- | --- | --- |
| `data-cleaner` | æ¸…æ´—ã€è¡¥å…¨ Tick æ•°æ®ï¼Œç”Ÿæˆè§„èŒƒåŒ–æ•°æ®æµ | `dfp:raw_ticks` | `dfp:clean_ticks` |
| `data-lake-writer` | æ‰¹é‡è½åœ°æ¸…æ´—åæ•°æ®ï¼Œå½¢æˆå†å²æ•°æ®æ¹– | `dfp:clean_ticks` | æœ¬åœ°æ•°æ®æ¹–ï¼ˆParquet/CSVï¼‰ |

## 3. ç‰¹å¾ä¸ç­–ç•¥

| æœåŠ¡ | èŒè´£ | è¾“å…¥ | è¾“å‡º |
| --- | --- | --- | --- |
| `feature-pipeline` | è®¡ç®—å¤šçª—å£é‡ä»·ç‰¹å¾ | `dfp:clean_ticks` | Redis å‘å¸ƒé¢‘é“ `dfp:features` |
| `strategy-engine` | åŠ è½½ç­–ç•¥æ’ä»¶å¹¶äº§ç”Ÿç­–ç•¥ä¿¡å· | `dfp:features` é¢‘é“ | `dfp:strategy_signals` Stream |

## 4. æœºä¼šèšåˆä¸é£é™©

| æœåŠ¡ | èŒè´£ | è¾“å…¥ | è¾“å‡º |
| --- | --- | --- | --- |
| `opportunity-aggregator` | å°†å¤šç­–ç•¥ä¿¡å·èšåˆæˆæœºä¼šï¼Œç»´æŠ¤ç”Ÿå‘½å‘¨æœŸ | `dfp:strategy_signals` | `dfp:opportunities` Streamã€`dfp:opportunities:ws` é¢‘é“ |
| `risk-guard` | åŸºäºæœºä¼šæµè¯†åˆ«ä½ç½®ä¿¡åº¦/åŠ¨èƒ½è¡°é€€ç­‰é£é™©å¹¶å‘Šè­¦ | `dfp:opportunities` | `dfp:risk_alerts` é¢‘é“ |

## 5. å¯¹å¤–æ¥å£

| æœåŠ¡ | èŒè´£ | è¾“å…¥ | è¾“å‡º |
| --- | --- | --- | --- |
| `signal-api` | æä¾› REST æ¥å£æŸ¥è¯¢æœºä¼šåˆ—è¡¨/è¯¦æƒ… | `dfp:opportunities` | HTTP JSON å“åº” |
| `signal-streamer` | WebSocket æ¨é€å®æ—¶æœºä¼š | `dfp:opportunities:ws` é¢‘é“ | WS æ¶ˆæ¯ |
| `backtest-service` | æä¾›ç­–ç•¥å›æµ‹ REST æ¥å£ | æ•°æ®æ¹–/æ¨¡æ‹Ÿæ•°æ® | å›æµ‹æŠ¥è¡¨ JSON |

## 6. å¯åŠ¨é¡ºåºå»ºè®®

1. å¯åŠ¨ Redisï¼ˆéœ€æŒä¹…åŒ–é…ç½®ï¼‰ã€‚
2. `collector-gateway` â†’ `stream-buffer` â†’ `data-cleaner` â†’ `data-lake-writer`ã€‚
3. `feature-pipeline` â†’ `strategy-engine`ã€‚
4. `opportunity-aggregator` â†’ `risk-guard`ã€‚
5. æŒ‰éœ€å¯åŠ¨ `signal-api`ã€`signal-streamer`ã€`backtest-service`ã€‚

å¯é€šè¿‡ `python -m compileall services/<service>` æˆ– `pytest` æ£€æŸ¥å„æœåŠ¡ä»£ç è´¨é‡ã€‚

## 7. ç»Ÿä¸€ç¯å¢ƒå˜é‡

æ‰€æœ‰æœåŠ¡å‡æ”¯æŒé€šè¿‡ `*_REDIS_URL` æŒ‡å®š Redis è¿æ¥ï¼Œé»˜è®¤ `redis://localhost:6379/0`ã€‚å…¶ä½™é…ç½®è¯·å‚è€ƒå„æœåŠ¡ READMEã€‚

> ğŸ“¦ æ•°æ®å¥‘çº¦ç»Ÿä¸€ç”± `libs/data_contracts` æä¾›ï¼Œå¯é€šè¿‡ `pip install -e libs/data_contracts` æˆ–æ‰§è¡Œå„æœåŠ¡çš„ `requirements.txt` å®‰è£…ï¼›è¿è¡Œè„šæœ¬å·²è‡ªåŠ¨æ³¨å…¥ `PYTHONPATH` ä»¥ä¾¿æœ¬åœ°å¼€å‘ã€‚
