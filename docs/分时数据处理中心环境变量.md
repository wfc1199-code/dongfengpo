# 分时数据处理中心环境变量

表格列出了重构服务常用的环境变量及默认值，方便本地或部署环境快速配置。建议在根目录复制 `.env.example` 至 `.env` 并按需调整。

## 通用

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `REDIS_URL` | Redis 连接串（部分服务通过前缀变量覆盖） | `redis://localhost:6379/0` |

## collector-gateway

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `COLLECTOR_STREAM_NAME` | 原始 Tick Stream 名称 | `dfp:raw_ticks` |
| `COLLECTOR_LOG_LEVEL` | 日志级别 | `INFO` |

## stream-buffer

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `BUFFER_PIPELINES` | JSON 数组，定义复制流水线 | `[]` |

## data-cleaner

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `CLEANER_INPUT_STREAM` | 输入 Stream | `dfp:raw_ticks` |
| `CLEANER_OUTPUT_STREAM` | 输出 Stream | `dfp:clean_ticks` |
| `CLEANER_CONSUMER_GROUP` | 消费者组名称 | `data-cleaner` |

## data-lake-writer

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `LAKE_WRITER_OUTPUT_DIR` | 数据落地目录 | `data-lake` |
| `LAKE_WRITER_FILE_FORMAT` | 输出格式 `parquet`/`csv` | `parquet` |

## feature-pipeline

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `FEATURE_PIPELINE_WINDOWS` | JSON 数组，定义多窗口计算 | 参见 `.env.example` |

## strategy-engine

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `STRATEGY_ENGINE_STRATEGIES` | JSON 数组，策略插件配置 | 默认加载 RapidRise |
| `STRATEGY_ENGINE_SIGNAL_STREAM` | 策略信号 Stream | `dfp:strategy_signals` |

## opportunity-aggregator

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `OPPORTUNITY_AGG_OPPORTUNITY_STREAM` | 机会输出 Stream | `dfp:opportunities` |
| `OPPORTUNITY_AGG_OPPORTUNITY_CHANNEL` | 推送频道 | `dfp:opportunities:ws` |
| `OPPORTUNITY_AGG_MAX_STREAM_LENGTH` | Stream 最大长度 | 空（不限制） |

## risk-guard

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `RISK_GUARD_RISK_CHANNEL` | 风险告警频道 | `dfp:risk_alerts` |
| `RISK_GUARD_VOLATILITY_THRESHOLD` | 波动率阈值 | `5.0` |
| `RISK_GUARD_DRAWDOWN_THRESHOLD` | 回撤阈值 | `8.0` |

## signal-api

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `SIGNAL_API_MAX_RECORDS` | 查询结果最大条数 | `200` |

## signal-streamer

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `SIGNAL_STREAMER_CHANNEL_NAME` | WebSocket 订阅频道 | `dfp:opportunities:ws` |

## backtest-service

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `BACKTEST_DATA_LAKE_DIR` | 历史数据目录 | `data-lake` |
| `BACKTEST_RESULTS_DIR` | 回测结果目录 | `backtest-results` |

## 前端（React）

| 变量 | 说明 | 默认值 |
| --- | --- | --- |
| `REACT_APP_API_URL` | Legacy 后端 API Base | `http://localhost:9000` |
| `REACT_APP_PIPELINE_API_URL` | 数据流水线 REST API | `http://localhost:8000` |
| `REACT_APP_PIPELINE_WS_URL` | 机会推送 WebSocket | `ws://localhost:8100/ws/opportunities` |

> 说明：JSON 类型变量请参考 `.env.example`，在 shell 中需注意引号转义。部署至容器或 Kubernetes 时，可将该文件转换为 ConfigMap 或 Secret。
