<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¶¨åœæ¿ç­–ç•¥æµ‹è¯• - é›†åˆç«ä»·é€‰è‚¡ & é¦–æ¿è¿›äºŒæ¿</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .strategy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .strategy-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .strategy-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .strategy-title {
            font-size: 1.4em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
            display: flex;
            align-items: center;
        }

        .strategy-title .icon {
            margin-right: 10px;
            font-size: 1.2em;
        }

        .strategy-description {
            color: #666;
            margin-bottom: 20px;
            font-size: 0.95em;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }

        .results {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.1em;
            color: #666;
        }

        .error {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #c33;
        }

        .success {
            background: #efe;
            color: #363;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #363;
        }

        .stock-list {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }

        .stock-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 2fr;
            gap: 15px;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .stock-name {
            font-weight: bold;
            color: #2c3e50;
        }

        .stock-code {
            font-size: 0.9em;
            color: #666;
        }

        .stock-price {
            font-weight: bold;
            color: #e74c3c;
        }

        .stock-change {
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 4px;
            color: white;
            text-align: center;
        }

        .positive {
            background: #27ae60;
        }

        .negative {
            background: #e74c3c;
        }

        .stock-reason {
            font-size: 0.9em;
            color: #666;
        }

        .time-info {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }

        .sentiment-indicator {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            color: white;
        }

        .sentiment-å¼ºåŠ¿ { background: #27ae60; }
        .sentiment-ä¹è§‚ { background: #f39c12; }
        .sentiment-ä¸­æ€§ { background: #95a5a6; }
        .sentiment-è°¨æ… { background: #e67e22; }
        .sentiment-æ‚²è§‚ { background: #e74c3c; }

        @media (max-width: 768px) {
            .strategy-grid {
                grid-template-columns: 1fr;
            }
            
            .stock-item {
                grid-template-columns: 1fr;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ æ¶¨åœæ¿æ™ºèƒ½ç­–ç•¥ç³»ç»Ÿ</h1>
            <div class="subtitle">åŸºäºä¸šå†…æˆç†Ÿç»éªŒ â€¢ é›†åˆç«ä»·é€‰è‚¡ â€¢ é¦–æ¿è¿›äºŒæ¿ç­–ç•¥</div>
        </div>

        <div class="strategy-grid">
            <!-- é›†åˆç«ä»·é€‰è‚¡ç­–ç•¥ -->
            <div class="strategy-card">
                <div class="strategy-title">
                    <span class="icon">ğŸ¯</span>
                    é›†åˆç«ä»·é€‰è‚¡ç­–ç•¥
                </div>
                <div class="strategy-description">
                    é€‚ç”¨æ—¶é—´ï¼š<strong>9:15-9:25</strong><br>
                    ç­›é€‰æ¡ä»¶ï¼šé«˜å¼€3-6%ï¼Œæˆäº¤æ´»è·ƒï¼Œå¸‚å€¼åˆç†<br>
                    ä¸šå†…æˆåŠŸç‡ï¼š<strong>65-75%</strong>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="getCallAuction()">è·å–é›†åˆç«ä»·é€‰è‚¡</button>
                    <button class="btn btn-secondary" onclick="getGoldenTimeStrategy()">é»„é‡‘æ—¶æ®µç­–ç•¥</button>
                </div>
            </div>

            <!-- é¦–æ¿è¿›äºŒæ¿ç­–ç•¥ -->
            <div class="strategy-card">
                <div class="strategy-title">
                    <span class="icon">ğŸ“ˆ</span>
                    é¦–æ¿è¿›äºŒæ¿ç­–ç•¥
                </div>
                <div class="strategy-description">
                    æ ¸å¿ƒé€»è¾‘ï¼šæ˜¨æ—¥æ¶¨åœä»Šæ—¥å»¶ç»­<br>
                    å…³é”®æ—¶ç‚¹ï¼š<strong>9:45</strong> åˆ¤æ–­å¸‚åœºæƒ…ç»ª<br>
                    é€‚åˆé£æ ¼ï¼š<strong>çŸ­çº¿äº¤æ˜“è€…</strong>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="getYesterdayPerformance()">æ˜¨æ—¥æ¶¨åœè¡¨ç°</button>
                    <button class="btn btn-secondary" onclick="getMarketSentiment()">å¸‚åœºæƒ…ç»ªåˆ†æ</button>
                </div>
            </div>

            <!-- æ—©ç›˜æ¶¨åœåˆ†æ -->
            <div class="strategy-card">
                <div class="strategy-title">
                    <span class="icon">ğŸŒ…</span>
                    æ—©ç›˜æ¶¨åœåˆ†æ
                </div>
                <div class="strategy-description">
                    é‡ç‚¹æ—¶æ®µï¼š<strong>10:30å‰</strong>æ¶¨åœè‚¡<br>
                    ç‰¹å¾åˆ†æï¼šå¼ºåº¦ã€æ¢æ‰‹ç‡ã€æ¿å—çƒ­åº¦<br>
                    æŒç»­æ€§ï¼šæ—©ç›˜æ¶¨åœå»¶ç»­æ€§æ›´å¼º
                </div>
                <div class="action-buttons">
                    <button class="btn btn-success" onclick="getEarlyLimitUp()">æ—©ç›˜æ¶¨åœåˆ†æ</button>
                    <button class="btn btn-secondary" onclick="professionalScreening()">ä¸“ä¸šçº§ç­›é€‰</button>
                </div>
            </div>

            <!-- ç»¼åˆåˆ†æ -->
            <div class="strategy-card">
                <div class="strategy-title">
                    <span class="icon">ğŸ”</span>
                    ç»¼åˆåˆ†æå·¥å…·
                </div>
                <div class="strategy-description">
                    å¤šç»´åº¦åˆ†æï¼šæ¿å—è½®åŠ¨ã€èµ„é‡‘æµå‘<br>
                    å®æ—¶ç›‘æ§ï¼šå¼‚åŠ¨è‚¡ç¥¨ã€é¾™å¤´è¯†åˆ«<br>
                    æ™ºèƒ½é¢„æµ‹ï¼šæ¶¨åœæ¦‚ç‡è®¡ç®—
                </div>
                <div class="action-buttons">
                    <button class="btn btn-success" onclick="scanMorningStars()">æ—©ç›˜æ˜æ˜Ÿè‚¡æ‰«æ</button>
                    <button class="btn btn-primary" onclick="getTimeBasedStrategy()">æ—¶é—´ç­–ç•¥æŒ‡å¯¼</button>
                </div>
            </div>
        </div>

        <!-- ç»“æœæ˜¾ç¤ºåŒºåŸŸ -->
        <div id="results" class="results" style="display: none;">
            <h2>åˆ†æç»“æœ</h2>
            <div id="content"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:9000/api/limit-up';

        function showLoading() {
            const results = document.getElementById('results');
            const content = document.getElementById('content');
            results.style.display = 'block';
            content.innerHTML = '<div class="loading">ğŸ”„ æ­£åœ¨åˆ†ææ•°æ®ï¼Œè¯·ç¨å€™...</div>';
            results.scrollIntoView({ behavior: 'smooth' });
        }

        function showError(message) {
            const content = document.getElementById('content');
            content.innerHTML = `<div class="error">âŒ ${message}</div>`;
        }

        function showResults(title, data) {
            const content = document.getElementById('content');
            content.innerHTML = `
                <h3>${title}</h3>
                <pre style="background: #f8f9fa; padding: 20px; border-radius: 8px; overflow-x: auto; white-space: pre-wrap;">${JSON.stringify(data, null, 2)}</pre>
            `;
        }

        // é›†åˆç«ä»·é€‰è‚¡
        async function getCallAuction() {
            showLoading();
            try {
                const response = await fetch(`${API_BASE}/call-auction`);
                const data = await response.json();
                
                if (data.success && data.data.stocks.length > 0) {
                    displayCallAuctionResults(data.data);
                } else {
                    showError('æš‚æ— é›†åˆç«ä»·å€™é€‰è‚¡ç¥¨');
                }
            } catch (error) {
                showError(`è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        function displayCallAuctionResults(data) {
            const timeInfo = data.time_info;
            const stocks = data.stocks;
            const summary = data.summary;

            let html = `
                <h3>ğŸ¯ é›†åˆç«ä»·é€‰è‚¡åˆ†æ</h3>
                <div class="time-info">
                    <strong>å½“å‰æ—¶é—´:</strong> ${timeInfo.current_time} | 
                    <strong>å¸‚åœºçŠ¶æ€:</strong> ${timeInfo.market_status} | 
                    <strong>æ˜¯å¦é›†åˆç«ä»·:</strong> ${timeInfo.is_call_auction ? 'æ˜¯' : 'å¦'}
                    <br><small>ğŸ’¡ ${timeInfo.optimal_usage}</small>
                </div>
                
                <div style="margin: 20px 0; padding: 15px; background: #e8f5e8; border-radius: 8px;">
                    <strong>ç­›é€‰ç»“æœ:</strong> 
                    æ€»å€™é€‰ ${summary.total_candidates} åª | 
                    ç²¾é€‰ ${summary.top_selected} åª | 
                    å¹³å‡è¯„åˆ† ${summary.average_score?.toFixed(1) || 0}
                </div>
                
                <div class="stock-list">
            `;

            stocks.forEach((stock, index) => {
                html += `
                    <div class="stock-item">
                        <div>
                            <div class="stock-name">${stock.stock_name}</div>
                            <div class="stock-code">${stock.stock_code}</div>
                        </div>
                        <div class="stock-price">Â¥${stock.current_price}</div>
                        <div class="stock-change positive">+${stock.change_percent?.toFixed(2)}%</div>
                        <div>è¯„åˆ†: <strong>${stock.auction_score}</strong></div>
                        <div class="stock-reason">${stock.reason || ''}</div>
                    </div>
                `;
            });

            html += '</div>';
            
            document.getElementById('content').innerHTML = html;
        }

        // æ—©ç›˜æ¶¨åœåˆ†æ
        async function getEarlyLimitUp() {
            showLoading();
            try {
                const response = await fetch(`${API_BASE}/early-limit-up`);
                const data = await response.json();
                
                if (data.success) {
                    displayEarlyLimitUpResults(data.data);
                } else {
                    showError('è·å–æ—©ç›˜æ¶¨åœæ•°æ®å¤±è´¥');
                }
            } catch (error) {
                showError(`è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        function displayEarlyLimitUpResults(data) {
            const stocks = data.early_limit_ups;
            const timeDistribution = data.time_distribution;
            const strengthAnalysis = data.strength_analysis;

            let html = `
                <h3>ğŸŒ… æ—©ç›˜æ¶¨åœè‚¡åˆ†æ</h3>
                <div class="time-info">
                    <strong>åˆ†ææ—¶é—´:</strong> ${data.analysis_time} | 
                    <strong>é»„é‡‘æ—¶æ®µ:</strong> ${data.is_golden_time ? 'æ˜¯' : 'å¦'}
                    <br><small>ğŸ’¡ ${data.strategy_tip}</small>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong>æ—¶é—´åˆ†å¸ƒ</strong><br>
                        9:30-10:00: ${timeDistribution['9:30-10:00']} åª<br>
                        10:00-10:30: ${timeDistribution['10:00-10:30']} åª
                    </div>
                    <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong>å¼ºåº¦åˆ†æ</strong><br>
                        æå¼º: ${strengthAnalysis.very_strong} åª<br>
                        å¼º: ${strengthAnalysis.strong} åª
                    </div>
                </div>
                
                <div class="stock-list">
            `;

            stocks.forEach(stock => {
                html += `
                    <div class="stock-item">
                        <div>
                            <div class="stock-name">${stock.stock_name}</div>
                            <div class="stock-code">${stock.stock_code} | ${stock.sector}</div>
                        </div>
                        <div class="stock-price">Â¥${stock.current_price}</div>
                        <div class="stock-change positive">+${stock.change_percent?.toFixed(2)}%</div>
                        <div>å¼ºåº¦: <strong>${stock.strength}</strong></div>
                        <div class="stock-reason">æ—©ç›˜æ¦‚ç‡: ${stock.early_probability}%</div>
                    </div>
                `;
            });

            html += '</div>';
            
            document.getElementById('content').innerHTML = html;
        }

        // æ˜¨æ—¥æ¶¨åœè¡¨ç°
        async function getYesterdayPerformance() {
            showLoading();
            try {
                const response = await fetch(`${API_BASE}/yesterday-performance`);
                const data = await response.json();
                
                if (data.success) {
                    displayYesterdayPerformance(data.data);
                } else {
                    showError('è·å–æ˜¨æ—¥æ¶¨åœè¡¨ç°å¤±è´¥');
                }
            } catch (error) {
                showError(`è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        function displayYesterdayPerformance(data) {
            const successRate = data.success_rate;
            const sentiment = data.market_sentiment;
            const suggestion = data.trading_suggestion;

            let html = `
                <h3>ğŸ“ˆ æ˜¨æ—¥æ¶¨åœè‚¡ä»Šæ—¥è¡¨ç°</h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong>æˆåŠŸç‡</strong><br>
                        <span style="font-size: 1.5em; color: #27ae60;">${successRate}%</span>
                    </div>
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong>å¸‚åœºæƒ…ç»ª</strong><br>
                        <span class="sentiment-indicator sentiment-${sentiment}">${sentiment}</span>
                    </div>
                    <div style="background: #f8d7da; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong>é£é™©è¯„ä¼°</strong><br>
                        <span>${data.risk_assessment}</span>
                    </div>
                </div>
                
                <div class="success">
                    ğŸ’¡ <strong>æ“ä½œå»ºè®®:</strong> ${suggestion}
                </div>
                
                <div class="stock-list">
            `;

            data.today_performance.forEach(stock => {
                const changeClass = stock.today_change >= 0 ? 'positive' : 'negative';
                const changePrefix = stock.today_change >= 0 ? '+' : '';
                
                html += `
                    <div class="stock-item">
                        <div>
                            <div class="stock-name">${stock.stock_name}</div>
                            <div class="stock-code">${stock.stock_code}</div>
                        </div>
                        <div>æ¢æ‰‹: ${stock.turnover_rate?.toFixed(2)}%</div>
                        <div class="stock-change ${changeClass}">${changePrefix}${stock.today_change?.toFixed(2)}%</div>
                        <div>${stock.is_continued ? 'âœ… å»¶ç»­' : 'âŒ å›è°ƒ'}</div>
                        <div class="stock-reason">å»¶ç»­å¼ºåº¦: ${stock.continuation_strength?.toFixed(0)}</div>
                    </div>
                `;
            });

            html += '</div>';
            
            document.getElementById('content').innerHTML = html;
        }

        // å¸‚åœºæƒ…ç»ªåˆ†æ
        async function getMarketSentiment() {
            showLoading();
            try {
                const response = await fetch(`${API_BASE}/market-sentiment`);
                const data = await response.json();
                
                if (data.success) {
                    displayMarketSentiment(data.data);
                } else {
                    showError('è·å–å¸‚åœºæƒ…ç»ªå¤±è´¥');
                }
            } catch (error) {
                showError(`è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        function displayMarketSentiment(data) {
            const guidance = data.trading_guidance;
            const stats = data.statistics;

            let html = `
                <h3>ğŸ’­ ç»¼åˆå¸‚åœºæƒ…ç»ªåˆ†æ</h3>
                
                <div style="text-align: center; margin: 20px 0;">
                    <div style="font-size: 2em; margin: 10px 0;">
                        <span class="sentiment-indicator sentiment-${data.sentiment_level}">${data.market_phase}</span>
                    </div>
                    <div style="font-size: 1.2em; color: #666;">
                        æƒ…ç»ªè¯„åˆ†: <strong>${data.sentiment_score}/100</strong>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong>æ¶¨åœè‚¡æ•°</strong><br>
                        ${stats.limit_up_count} åª
                    </div>
                    <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong>å¼ºåŠ¿è‚¡æ•°</strong><br>
                        ${stats.strong_stocks_count} åª
                    </div>
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong>çƒ­é—¨æ¿å—</strong><br>
                        ${stats.hot_sectors_count} ä¸ª
                    </div>
                </div>
                
                <div class="success">
                    <strong>äº¤æ˜“æŒ‡å¯¼:</strong><br>
                    ğŸ’¡ ${guidance.suggestion}<br>
                    ğŸ“Š å»ºè®®ä»“ä½: ${guidance.position_advice}<br>
                    âš ï¸ æ­¢æŸç­–ç•¥: ${guidance.stop_loss}
                </div>
            `;
            
            document.getElementById('content').innerHTML = html;
        }

        // é»„é‡‘æ—¶æ®µç­–ç•¥
        async function getGoldenTimeStrategy() {
            showLoading();
            try {
                const response = await fetch(`${API_BASE}/golden-time-strategy`);
                const data = await response.json();
                showResults('ğŸ† é»„é‡‘æ—¶æ®µç­–ç•¥', data);
            } catch (error) {
                showError(`è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        // æ—©ç›˜æ˜æ˜Ÿè‚¡æ‰«æ
        async function scanMorningStars() {
            showLoading();
            try {
                const response = await fetch(`${API_BASE}/scan/morning-stars`);
                const data = await response.json();
                showResults('â­ æ—©ç›˜æ˜æ˜Ÿè‚¡æ‰«æ', data);
            } catch (error) {
                showError(`è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        // æ—¶é—´ç­–ç•¥æŒ‡å¯¼
        async function getTimeBasedStrategy() {
            showLoading();
            try {
                const response = await fetch(`${API_BASE}/strategy/time-based`);
                const data = await response.json();
                showResults('â° æ—¶é—´ç­–ç•¥æŒ‡å¯¼', data);
            } catch (error) {
                showError(`è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        // ä¸“ä¸šçº§ç­›é€‰
        async function professionalScreening() {
            showLoading();
            try {
                const response = await fetch(`${API_BASE}/professional-screening`);
                const data = await response.json();
                showResults('ğŸ¯ ä¸“ä¸šçº§ç­›é€‰', data);
            } catch (error) {
                showError(`è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }
    </script>
</body>
</html>