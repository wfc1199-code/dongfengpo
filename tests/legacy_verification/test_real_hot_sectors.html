<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>æµ‹è¯•çœŸå®çƒ­é—¨æ¿å—API</title>
    <style>
        body {
            font-family: 'SF Pro', Arial, sans-serif;
            padding: 20px;
            background: #0a0e27;
            color: #fff;
        }
        h1 {
            color: #f39c12;
        }
        .sector-card {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #f39c12;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .sector-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .sector-name {
            font-size: 20px;
            font-weight: bold;
            color: #ffd700;
        }
        .sector-change {
            font-size: 24px;
            font-weight: bold;
            color: #ff4757;
        }
        .sector-stats {
            display: flex;
            gap: 20px;
            font-size: 14px;
            color: #ddd;
        }
        .stat-item {
            padding: 5px 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }
        button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        #loading {
            text-align: center;
            padding: 30px;
            color: #f39c12;
            font-size: 18px;
        }
        .api-info {
            background: rgba(52, 152, 219, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
    </style>
</head>
<body>
    <h1>ğŸ”¥ ä¸œæ–¹è´¢å¯Œçƒ­é—¨æ¦‚å¿µæ¿å— - å®æ—¶æ•°æ®æµ‹è¯•</h1>

    <div class="api-info">
        <strong>APIåœ°å€:</strong> http://localhost:9000/api/market-scanner/hot-sectors<br>
        <strong>æ•°æ®æº:</strong> ä¸œæ–¹è´¢å¯Œç›´æ¥API (push2.eastmoney.com)<br>
        <strong>æ›´æ–°æ—¶é—´:</strong> <span id="updateTime">-</span>
    </div>

    <div>
        <button onclick="loadData()">ğŸ”„ åˆ·æ–°æ•°æ®</button>
        <button onclick="window.location.href='http://localhost:3000'">ğŸ  è¿”å›ä¸»é¡µ</button>
    </div>

    <div id="loading" style="display: none;">â³ æ­£åœ¨åŠ è½½æ•°æ®...</div>
    <div id="result"></div>

    <script>
        async function loadData() {
            const resultDiv = document.getElementById('result');
            const loadingDiv = document.getElementById('loading');
            const updateTimeSpan = document.getElementById('updateTime');

            loadingDiv.style.display = 'block';
            resultDiv.innerHTML = '';

            try {
                console.log('è¯·æ±‚API...');
                const response = await fetch('http://localhost:9000/api/market-scanner/hot-sectors?limit=15');
                const data = await response.json();

                console.log('APIè¿”å›:', data);

                if (data.code === 200 && data.data && data.data.sectors) {
                    const sectors = data.data.sectors;
                    const dataSource = data.data.data_source;
                    const updatedAt = new Date(data.data.updated_at).toLocaleTimeString('zh-CN');

                    updateTimeSpan.textContent = updatedAt + ' (' + dataSource + ')';

                    let html = `<h2>å…± ${sectors.length} ä¸ªçƒ­é—¨æ¿å—</h2>`;

                    sectors.forEach((sector, index) => {
                        const changeClass = sector.avg_change >= 0 ? 'positive' : 'negative';
                        const rankEmoji = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : `${index + 1}`;

                        html += `
                            <div class="sector-card">
                                <div class="sector-header">
                                    <div>
                                        <span style="font-size: 28px; margin-right: 10px;">${rankEmoji}</span>
                                        <span class="sector-name">${sector.sector_name}</span>
                                        <span style="font-size: 12px; color: #888; margin-left: 10px;">${sector.category}</span>
                                    </div>
                                    <div class="sector-change ${changeClass}">
                                        ${sector.avg_change >= 0 ? '+' : ''}${sector.avg_change.toFixed(2)}%
                                    </div>
                                </div>
                                <div class="sector-stats">
                                    <div class="stat-item">
                                        ğŸ“Š ${sector.stock_count} åªè‚¡ç¥¨
                                    </div>
                                    <div class="stat-item">
                                        â¬†ï¸ æ¶¨ ${sector.up_count} å®¶
                                    </div>
                                    <div class="stat-item">
                                        â¬‡ï¸ è·Œ ${sector.down_count} å®¶
                                    </div>
                                    ${sector.limit_up_count > 0 ? `
                                        <div class="stat-item" style="color: #ff4757; font-weight: bold;">
                                            ğŸš€ æ¶¨åœ ${sector.limit_up_count} åª
                                        </div>
                                    ` : ''}
                                    ${sector.is_confirmed ? `
                                        <div class="stat-item" style="color: #26de81; font-weight: bold;">
                                            âœ“ ç¡®æƒ
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        `;
                    });

                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.innerHTML = '<p style="color: #ff4757;">âŒ APIè¿”å›é”™è¯¯: ' + (data.message || 'æœªçŸ¥é”™è¯¯') + '</p>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<p style="color: #ff4757;">âŒ è¯·æ±‚å¤±è´¥: ' + error.message + '</p>';
                console.error('è¯·æ±‚å¤±è´¥:', error);
            } finally {
                loadingDiv.style.display = 'none';
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨åŠ è½½æ•°æ®
        window.onload = () => {
            loadData();
        };
    </script>
</body>
</html>
