<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Yè½´è°ƒè¯•</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #fff; }
        .case { margin: 20px 0; padding: 15px; border: 1px solid #333; background: #2a2a2a; }
        .error { color: #f44336; }
        .success { color: #4CAF50; }
        .warning { color: #FF9800; }
    </style>
</head>
<body>
    <h1>åˆ†æ—¶å›¾Yè½´åˆ»åº¦æµ‹è¯•</h1>
    <div id="results"></div>

    <script>
        function testYAxis(code, name, yesterdayClose) {
            // åˆ¤æ–­æ¶¨è·Œåœ
            let limitPercent = 0.1;
            const pureCode = code.replace(/^(sh|sz|hk)/, '');
            
            if (pureCode.startsWith('688') || pureCode.startsWith('689')) {
                limitPercent = 0.2;
            } else if (pureCode.startsWith('300')) {
                limitPercent = 0.2;
            }
            
            const yAxisMax = yesterdayClose * (1 + limitPercent);
            const yAxisMin = yesterdayClose * (1 - limitPercent);
            const interval = (yAxisMax - yAxisMin) / 4;
            
            // ç”ŸæˆYè½´åˆ»åº¦
            const ticks = [];
            for (let i = 0; i <= 4; i++) {
                const value = yAxisMin + interval * i;
                const percent = ((value - yesterdayClose) / yesterdayClose * 100);
                ticks.push({
                    value: value.toFixed(2),
                    percent: percent.toFixed(2) + '%'
                });
            }
            
            // æ£€æŸ¥0è½´æ˜¯å¦åœ¨åˆ»åº¦ä¸­
            const hasZeroTick = ticks.some(t => Math.abs(parseFloat(t.value) - yesterdayClose) < 0.01);
            
            const div = document.createElement('div');
            div.className = 'case';
            div.innerHTML = `
                <h3>${name} (${code}) - ${limitPercent * 100}%æ¶¨è·Œå¹…</h3>
                <div>æ˜¨æ”¶ä»·: ${yesterdayClose.toFixed(2)}</div>
                <div>Yè½´èŒƒå›´: [${yAxisMin.toFixed(2)}, ${yAxisMax.toFixed(2)}]</div>
                <div>åˆ»åº¦é—´éš”: ${interval.toFixed(2)}</div>
                <div style="margin-top: 10px;">Yè½´åˆ»åº¦ç‚¹:</div>
                <ul>
                    ${ticks.map((t, i) => {
                        const isZero = Math.abs(parseFloat(t.value) - yesterdayClose) < 0.01;
                        return `<li class="${isZero ? 'success' : ''}">${t.value} (${t.percent}) ${isZero ? 'â† 0è½´' : ''}</li>`;
                    }).join('')}
                </ul>
                <div class="${hasZeroTick ? 'success' : 'error'}">
                    ${hasZeroTick ? 'âœ“ 0è½´åœ¨åˆ»åº¦ç‚¹ä¸Š' : 'âœ— 0è½´ä¸åœ¨åˆ»åº¦ç‚¹ä¸Šï¼ˆè¿™ä¼šå¯¼è‡´æ˜¾ç¤ºé—®é¢˜ï¼‰'}
                </div>
            `;
            
            return div;
        }
        
        const resultsDiv = document.getElementById('results');
        
        // æµ‹è¯•ä¸åŒè‚¡ç¥¨
        resultsDiv.appendChild(testYAxis('002864', 'ç›˜é¾™è¯ä¸š', 32.50));
        resultsDiv.appendChild(testYAxis('688291', 'é‡‘æ©™å­', 29.03));
        resultsDiv.appendChild(testYAxis('000001', 'å¹³å®‰é“¶è¡Œ', 10.00));
        resultsDiv.appendChild(testYAxis('600519', 'è´µå·èŒ…å°', 1500.00));
        
        // æ·»åŠ è¯´æ˜
        const note = document.createElement('div');
        note.style.marginTop = '30px';
        note.style.padding = '20px';
        note.style.background = '#2a2a2a';
        note.style.borderRadius = '5px';
        note.innerHTML = `
            <h2>ğŸ“ é—®é¢˜åˆ†æ</h2>
            <p class="warning">å½“ä½¿ç”¨ <code>interval = (max - min) / 4</code> æ—¶ï¼š</p>
            <ul>
                <li>Yè½´ä¼šè¢«ç­‰åˆ†ä¸º4æ®µ</li>
                <li>ç”Ÿæˆ5ä¸ªåˆ»åº¦ç‚¹ï¼ˆ0,1,2,3,4ï¼‰</li>
                <li><strong>0è½´ï¼ˆæ˜¨æ”¶ä»·ï¼‰ä¸ä¸€å®šåœ¨åˆ»åº¦ç‚¹ä¸Šï¼</strong></li>
            </ul>
            <h3>è§£å†³æ–¹æ¡ˆ</h3>
            <p class="success">è®©EChartsè‡ªåŠ¨è®¡ç®—åˆ»åº¦ï¼Œæˆ–è€…å¼ºåˆ¶è®©0è½´æˆä¸ºä¸­é—´åˆ»åº¦ç‚¹ï¼š</p>
            <ul>
                <li>æ–¹æ¡ˆ1: ä¸è®¾ç½® <code>interval</code>ï¼Œè®©EChartsè‡ªåŠ¨è®¡ç®—</li>
                <li>æ–¹æ¡ˆ2: è®¾ç½® <code>splitNumber: 4</code> æ›¿ä»£ <code>interval</code></li>
                <li>æ–¹æ¡ˆ3: æ‰‹åŠ¨è®¡ç®—åˆ»åº¦ï¼Œç¡®ä¿æ˜¨æ”¶ä»·åœ¨ä¸­é—´</li>
            </ul>
        `;
        resultsDiv.appendChild(note);
    </script>
</body>
</html>
