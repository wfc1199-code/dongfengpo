<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Yè½´èŒƒå›´æµ‹è¯•</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #fff; }
        .test-case { margin: 20px 0; padding: 15px; border: 1px solid #333; }
        .stock-info { color: #4CAF50; }
        .calculation { color: #FF9800; margin-left: 20px; }
        .result { color: #2196F3; margin-left: 40px; }
        .error { color: #f44336; }
        .success { color: #4CAF50; }
    </style>
</head>
<body>
    <h1>åˆ†æ—¶å›¾Yè½´èŒƒå›´æµ‹è¯•</h1>
    <div id="results"></div>

    <script>
        function testYAxisRange(stockCode, yesterdayClose, currentPrice) {
            const result = document.createElement('div');
            result.className = 'test-case';
            
            // åˆ¤æ–­æ¶¨è·Œåœæ¿é™åˆ¶
            let limitPercent = 0.1; // é»˜è®¤ä¸»æ¿10%
            let boardType = 'ä¸»æ¿';
            
            if (stockCode.startsWith('688') || stockCode.startsWith('sz688') || stockCode.startsWith('sh688')) {
                limitPercent = 0.2;
                boardType = 'ç§‘åˆ›æ¿';
            } else if (stockCode.startsWith('300') || stockCode.startsWith('sz300') || stockCode.startsWith('sh300')) {
                limitPercent = 0.2;
                boardType = 'åˆ›ä¸šæ¿';
            } else if (stockCode.startsWith('hk')) {
                limitPercent = 1.0;
                boardType = 'æ¸¯è‚¡';
            }
            
            // è®¡ç®—Yè½´èŒƒå›´
            const yAxisMax = yesterdayClose * (1 + limitPercent);
            const yAxisMin = yesterdayClose * (1 - limitPercent);
            
            // æ£€æŸ¥å½“å‰ä»·æ ¼æ˜¯å¦åœ¨èŒƒå›´å†…
            const inRange = currentPrice >= yAxisMin && currentPrice <= yAxisMax;
            
            // è®¡ç®—æ¶¨è·Œå¹…
            const changePercent = ((currentPrice - yesterdayClose) / yesterdayClose * 100);
            
            result.innerHTML = `
                <div class="stock-info">ğŸ“Š è‚¡ç¥¨ä»£ç : ${stockCode} (${boardType}, æ¶¨è·Œå¹…é™åˆ¶: ${limitPercent * 100}%)</div>
                <div class="calculation">
                    æ˜¨æ”¶ä»·: ${yesterdayClose.toFixed(2)}<br>
                    å½“å‰ä»·: ${currentPrice.toFixed(2)} (${changePercent >= 0 ? '+' : ''}${changePercent.toFixed(2)}%)
                </div>
                <div class="result">
                    Yè½´æœ€å¤§å€¼: ${yAxisMax.toFixed(2)} (æ¶¨åœä»·)<br>
                    Yè½´æœ€å°å€¼: ${yAxisMin.toFixed(2)} (è·Œåœä»·)<br>
                    <span class="${inRange ? 'success' : 'error'}">
                        âœ“ å½“å‰ä»·æ ¼${inRange ? 'åœ¨' : 'è¶…å‡º'}Yè½´èŒƒå›´
                    </span>
                </div>
            `;
            
            return result;
        }
        
        // æµ‹è¯•ç”¨ä¾‹
        const testCases = [
            { code: '002864', yesterday: 32.50, current: 32.96, name: 'ç›˜é¾™è¯ä¸š' },
            { code: '688291', yesterday: 29.03, current: 34.84, name: 'é‡‘æ©™å­' },
            { code: '001229', yesterday: 40.69, current: 42.85, name: 'é­…è§†ç§‘æŠ€' },
            { code: '300750', yesterday: 100.00, current: 110.00, name: 'å®å¾·æ—¶ä»£(å‡è®¾)' },
            { code: '600519', yesterday: 1500.00, current: 1520.00, name: 'è´µå·èŒ…å°(å‡è®¾)' },
        ];
        
        const resultsDiv = document.getElementById('results');
        testCases.forEach(test => {
            resultsDiv.appendChild(testYAxisRange(test.code, test.yesterday, test.current));
        });
        
        // æ·»åŠ è¯´æ˜
        const explanation = document.createElement('div');
        explanation.style.marginTop = '30px';
        explanation.style.padding = '20px';
        explanation.style.background = '#2a2a2a';
        explanation.style.borderRadius = '5px';
        explanation.innerHTML = `
            <h2>ğŸ“ æ¶¨è·Œåœæ¿è§„åˆ™è¯´æ˜</h2>
            <ul>
                <li><strong>ä¸»æ¿</strong>ï¼ˆ600/601/603/000/002å¼€å¤´ï¼‰: Â±10%</li>
                <li><strong>ç§‘åˆ›æ¿</strong>ï¼ˆ688å¼€å¤´ï¼‰: Â±20%</li>
                <li><strong>åˆ›ä¸šæ¿</strong>ï¼ˆ300å¼€å¤´ï¼‰: Â±20%</li>
                <li><strong>æ¸¯è‚¡</strong>ï¼ˆhkå¼€å¤´ï¼‰: æ— æ¶¨è·Œåœé™åˆ¶</li>
            </ul>
            <h3>âš ï¸ åˆ†æ—¶å›¾Yè½´èŒƒå›´è®¡ç®—</h3>
            <p>Yè½´èŒƒå›´åº”è¯¥ä¸¥æ ¼æŒ‰ç…§æ¶¨è·Œåœæ¿é™åˆ¶è®¾ç½®ï¼š</p>
            <ul>
                <li>æœ€å¤§å€¼ = æ˜¨æ”¶ä»· Ã— (1 + æ¶¨è·Œå¹…é™åˆ¶)</li>
                <li>æœ€å°å€¼ = æ˜¨æ”¶ä»· Ã— (1 - æ¶¨è·Œå¹…é™åˆ¶)</li>
            </ul>
            <p><strong>0è½´</strong>ï¼ˆæ˜¨æ”¶ä»·çº¿ï¼‰åº”è¯¥å§‹ç»ˆåœ¨Yè½´çš„æ­£ä¸­é—´ä½ç½®ï¼</p>
        `;
        resultsDiv.appendChild(explanation);
    </script>
</body>
</html>
