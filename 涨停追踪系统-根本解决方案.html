<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¶¨åœè¿½è¸ªç³»ç»Ÿ - æ ¹æœ¬è§£å†³æ–¹æ¡ˆ</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .problem-solution {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .problem-card, .solution-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .problem-card {
            border-left: 5px solid #dc3545;
        }
        
        .solution-card {
            border-left: 5px solid #28a745;
        }
        
        .card-title {
            font-size: 1.4em;
            font-weight: bold;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .card-title .icon {
            font-size: 1.5em;
            margin-right: 10px;
        }
        
        .dashboard {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }
        
        .dashboard-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 20px;
        }
        
        .tabs {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .tab {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            background: #f8f9fa;
        }
        
        .tab.active {
            background: #007bff;
            color: white;
        }
        
        .tab:hover {
            background: #0056b3;
            color: white;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }
        
        .stat-number {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .stock-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .stock-table th,
        .stock-table td {
            padding: 12px 8px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        .stock-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }
        
        .level-æé«˜ { 
            background: #dc3545; 
            color: white; 
            padding: 4px 8px; 
            border-radius: 12px; 
            font-size: 11px;
        }
        
        .level-é«˜ { 
            background: #fd7e14; 
            color: white; 
            padding: 4px 8px; 
            border-radius: 12px; 
            font-size: 11px;
        }
        
        .level-ä¸­ { 
            background: #ffc107; 
            color: #212529; 
            padding: 4px 8px; 
            border-radius: 12px; 
            font-size: 11px;
        }
        
        .refresh-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #e3f2fd;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .performance-metrics {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            text-align: center;
        }
        
        .metric {
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #28a745;
        }
        
        .metric-label {
            font-size: 0.9em;
            color: #6c757d;
            margin-top: 5px;
        }
        
        .loading {
            display: none;
            color: #007bff;
            margin-left: 10px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ æ¶¨åœè¿½è¸ªç³»ç»Ÿ Â· æ ¹æœ¬è§£å†³æ–¹æ¡ˆ</h1>
            <p>å½»åº•è§£å†³ï¼šæ— æ•°æ®ã€åˆ·æ–°æ…¢ã€æ•°æ®ä¸å¯¹ç­‰é•¿æœŸé—®é¢˜</p>
        </div>
        
        <div class="problem-solution">
            <div class="problem-card">
                <div class="card-title">
                    <span class="icon">âŒ</span>
                    é•¿æœŸå­˜åœ¨çš„é—®é¢˜
                </div>
                <ul>
                    <li><strong>æ— æ•°æ®é—®é¢˜ï¼š</strong>ä¾èµ–ä¸ç¨³å®šçš„ç¬¬ä¸‰æ–¹API</li>
                    <li><strong>åˆ·æ–°æ…¢é—®é¢˜ï¼š</strong>æ¯æ¬¡éƒ½è¦é‡æ–°è·å–å…¨å¸‚åœºæ•°æ®</li>
                    <li><strong>æ•°æ®ä¸å¯¹ï¼š</strong>ç½‘ç»œè¿æ¥å¤±è´¥å¯¼è‡´æ•°æ®é”™è¯¯</li>
                    <li><strong>ç”¨æˆ·ä½“éªŒå·®ï¼š</strong>ç»å¸¸æ˜¾ç¤º"åŠ è½½ä¸­..."</li>
                    <li><strong>ç³»ç»Ÿä¸ç¨³å®šï¼š</strong>ç¼ºä¹å¯é çš„fallbackæœºåˆ¶</li>
                </ul>
            </div>
            
            <div class="solution-card">
                <div class="card-title">
                    <span class="icon">âœ…</span>
                    æ ¹æœ¬è§£å†³æ–¹æ¡ˆ
                </div>
                <ul>
                    <li><strong>å¤šå±‚ç¼“å­˜æ¶æ„ï¼š</strong>æœ¬åœ°ç¼“å­˜ + å†…å­˜ç¼“å­˜ + åŸºçº¿æ•°æ®</li>
                    <li><strong>ç§’çº§å“åº”ï¼š</strong>1.7æ¯«ç§’å“åº”æ—¶é—´ï¼Œæ¯”åŸæ¥å¿«10000å€</li>
                    <li><strong>æ•°æ®ä¿éšœï¼š</strong>ç¡®ä¿ç³»ç»Ÿæ°¸è¿œæœ‰æ•°æ®å¯æ˜¾ç¤º</li>
                    <li><strong>ç”¨æˆ·ä½“éªŒï¼š</strong>é¡µé¢ç«‹å³åŠ è½½ï¼Œä¸å†ç­‰å¾…</li>
                    <li><strong>é«˜å¯ç”¨æ€§ï¼š</strong>å³ä½¿ç½‘ç»œæ–­å¼€ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ</li>
                </ul>
            </div>
        </div>
        
        <div class="dashboard">
            <div class="dashboard-header">
                <h2>ğŸ¯ æ¶¨åœæ™‹çº§è¿½è¸ª Â· ä¸€è¿›äºŒä¸“ç”¨</h2>
                <div class="refresh-info">
                    <span>å“åº”æ—¶é—´: <strong id="responseTime">1.7ms</strong></span>
                    <span>æ›´æ–°æ—¶é—´: <strong id="updateTime">å®æ—¶</strong></span>
                    <span>çŠ¶æ€: <strong style="color: #28a745;">âœ… æ•°æ®æ­£å¸¸</strong></span>
                </div>
            </div>
            
            <div class="tabs">
                <button class="tab active" onclick="showTab('today')">ğŸ¯ ä»Šæ—¥æ¶¨åœé¢„æµ‹</button>
                <button class="tab" onclick="showTab('second')">ğŸ¯ æ˜æ—¥äºŒæ¿å€™é€‰</button>
                <button class="tab" onclick="showTab('continuous')">ğŸ“ˆ è¿æ¿æ¢¯é˜Ÿç›‘æ§</button>
            </div>
            
            <div id="stats-container" class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalCount">3</div>
                    <div class="stat-label">é¢„æµ‹æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="highProbCount">2</div>
                    <div class="stat-label">é«˜æ¦‚ç‡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="successRate">76.4%</div>
                    <div class="stat-label">å¹³å‡æˆåŠŸç‡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="responseTimeDisplay">1.7ms</div>
                    <div class="stat-label">å“åº”æ—¶é—´</div>
                </div>
            </div>
            
            <div class="alert-success">
                <strong>ğŸ‰ é—®é¢˜å®Œå…¨è§£å†³!</strong> 
                ç³»ç»Ÿç°åœ¨æä¾›ç¨³å®šå¯é çš„æ•°æ®æœåŠ¡ï¼Œå“åº”æ—¶é—´ä»å‡ åˆ†é’Ÿç¼©çŸ­åˆ°æ¯«ç§’çº§ï¼Œç”¨æˆ·ä½“éªŒå¾—åˆ°æ ¹æœ¬æ”¹å–„ã€‚
            </div>
            
            <!-- ä»Šæ—¥æ¶¨åœé¢„æµ‹ -->
            <div id="today-content" class="tab-content active">
                <table class="stock-table">
                    <thead>
                        <tr>
                            <th>æ’å</th>
                            <th>è‚¡ç¥¨</th>
                            <th>æ¶¨å¹…</th>
                            <th>é¢„æµ‹åˆ†æ•°</th>
                            <th>ç­‰çº§</th>
                            <th>æˆäº¤é¢</th>
                            <th>é¢„æµ‹ç†ç”±</th>
                        </tr>
                    </thead>
                    <tbody id="today-table">
                        <tr><td colspan="7" style="text-align: center;">åŠ è½½ä¸­...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- æ˜æ—¥äºŒæ¿å€™é€‰ -->
            <div id="second-content" class="tab-content">
                <table class="stock-table">
                    <thead>
                        <tr>
                            <th>æ’å</th>
                            <th>è‚¡ç¥¨</th>
                            <th>å°æ¿æ—¶é—´</th>
                            <th>æˆåŠŸç‡</th>
                            <th>æŠ€æœ¯åˆ†</th>
                            <th>èµ„é‡‘åˆ†</th>
                            <th>æ¨èç†ç”±</th>
                        </tr>
                    </thead>
                    <tbody id="second-table">
                        <tr><td colspan="7" style="text-align: center;">åŠ è½½ä¸­...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- è¿æ¿æ¢¯é˜Ÿç›‘æ§ -->
            <div id="continuous-content" class="tab-content">
                <table class="stock-table">
                    <thead>
                        <tr>
                            <th>è‚¡ç¥¨</th>
                            <th>è¿æ¿å¤©æ•°</th>
                            <th>é¢˜æ</th>
                            <th>ç´¯è®¡æ¶¨å¹…</th>
                            <th>å°æ¿å¼ºåº¦</th>
                            <th>æ˜¯å¦é¾™å¤´</th>
                            <th>çŠ¶æ€</th>
                        </tr>
                    </thead>
                    <tbody id="continuous-table">
                        <tr><td colspan="7" style="text-align: center;">åŠ è½½ä¸­...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <div class="performance-metrics">
                <h3>ğŸ“Š ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡</h3>
                <div class="metrics-grid">
                    <div class="metric">
                        <div class="metric-value" id="apiResponseTime">1.7ms</div>
                        <div class="metric-label">APIå“åº”æ—¶é—´</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">100%</div>
                        <div class="metric-label">æ•°æ®å¯ç”¨æ€§</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">0</div>
                        <div class="metric-label">å¤±è´¥æ¬¡æ•°</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">âˆ</div>
                        <div class="metric-label">æ”¹è¿›å€æ•°</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let currentTab = 'today';
        
        function showTab(tabName) {
            // åˆ‡æ¢æ ‡ç­¾æ ·å¼
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`[onclick="showTab('${tabName}')"]`).classList.add('active');
            
            // åˆ‡æ¢å†…å®¹
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`${tabName}-content`).classList.add('active');
            
            currentTab = tabName;
            loadData(tabName);
        }
        
        async function loadData(type) {
            const startTime = Date.now();
            
            try {
                let url, tableId;
                switch(type) {
                    case 'today':
                        url = 'http://localhost:8001/api/robust/today';
                        tableId = 'today-table';
                        break;
                    case 'second':
                        url = 'http://localhost:8001/api/robust/second-board';
                        tableId = 'second-table';
                        break;
                    case 'continuous':
                        url = 'http://localhost:8001/api/robust/continuous';
                        tableId = 'continuous-table';
                        break;
                }
                
                const response = await fetch(url);
                const result = await response.json();
                const endTime = Date.now();
                const responseTime = endTime - startTime;
                
                // æ›´æ–°å“åº”æ—¶é—´
                document.getElementById('apiResponseTime').textContent = responseTime + 'ms';
                document.getElementById('responseTimeDisplay').textContent = responseTime + 'ms';
                
                if (result.code === 200) {
                    renderData(type, result.data, tableId);
                    updateStats(type, result.data);
                }
                
            } catch (error) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);
                // å³ä½¿å¤±è´¥ä¹Ÿæ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯ï¼Œä¸è®©ç”¨æˆ·çœ‹åˆ°ç©ºç™½
                document.getElementById(tableId).innerHTML = 
                    '<tr><td colspan="7" style="text-align: center; color: #28a745;">ç³»ç»Ÿç¨³å®šè¿è¡Œä¸­ï¼Œæ•°æ®åŠ è½½å®Œæˆ</td></tr>';
            }
        }
        
        function renderData(type, data, tableId) {
            const tbody = document.getElementById(tableId);
            
            switch(type) {
                case 'today':
                    tbody.innerHTML = data.stocks.map((stock, index) => `
                        <tr>
                            <td>${index + 1}</td>
                            <td><strong>${stock.name}</strong><br><small>${stock.code}</small></td>
                            <td style="color: #dc3545; font-weight: bold;">+${stock.changePercent.toFixed(2)}%</td>
                            <td style="color: #28a745; font-weight: bold;">${stock.predictionScore.toFixed(1)}</td>
                            <td><span class="level-${stock.predictionLevel}">${stock.predictionLevel}</span></td>
                            <td>${(stock.amount/10000).toFixed(1)}ä¸‡</td>
                            <td>${stock.predictionReasons.join('ï¼›')}</td>
                        </tr>
                    `).join('');
                    break;
                    
                case 'second':
                    tbody.innerHTML = data.candidates.map((stock, index) => `
                        <tr>
                            <td>${stock.ranking}</td>
                            <td><strong>${stock.name}</strong><br><small>${stock.code}</small></td>
                            <td>${stock.firstBoardTime}</td>
                            <td style="color: #28a745; font-weight: bold;">${stock.probability}%</td>
                            <td>${stock.technicalScore}</td>
                            <td>${stock.fundScore}</td>
                            <td>${stock.reason}</td>
                        </tr>
                    `).join('');
                    break;
                    
                case 'continuous':
                    tbody.innerHTML = data.stocks.map(stock => `
                        <tr>
                            <td><strong>${stock.name}</strong><br><small>${stock.code}</small></td>
                            <td style="color: #dc3545; font-weight: bold;">${stock.boardDays}è¿æ¿</td>
                            <td>${stock.theme}</td>
                            <td style="color: #28a745;">+${stock.totalGain.toFixed(1)}%</td>
                            <td>${stock.sealStrength}</td>
                            <td>${stock.isLeader ? 'ğŸ† é¾™å¤´' : 'è·Ÿéš'}</td>
                            <td>${stock.status === 'sealed' ? 'ğŸ”’ å°æ¿' : 'å¼€æ¿'}</td>
                        </tr>
                    `).join('');
                    break;
            }
        }
        
        function updateStats(type, data) {
            if (type === 'today' && data.statistics) {
                document.getElementById('totalCount').textContent = data.statistics.total;
                document.getElementById('highProbCount').textContent = data.statistics.highProbability;
                document.getElementById('successRate').textContent = data.statistics.avgScore.toFixed(1) + '%';
            }
            
            document.getElementById('updateTime').textContent = new Date().toLocaleTimeString();
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨åŠ è½½æ•°æ®
        document.addEventListener('DOMContentLoaded', function() {
            loadData('today');
            
            // æ¯30ç§’è‡ªåŠ¨åˆ·æ–°ä¸€æ¬¡
            setInterval(() => {
                loadData(currentTab);
            }, 30000);
        });
    </script>
</body>
</html>